# Simplified enrollment config using pre-processed payload
# Use with EnrollmentApplicationPreProcessor

composition:
  base: templates/base-payer.yml

pdfMerge:
  sections:
    # Main enrollment form (AcroForm with fixed slots)
    - name: enrollment-application
      type: acroform
      template: enrollment-application-with-dependents.pdf
      enabled: true
      fieldMapping:
        # ===== APPLICATION LEVEL =====
        "ApplicationId": "applicationId"
        "SubmittedDate": "submittedDate"
        "EffectiveDate": "effectiveDate"
        
        # ===== PRIMARY APPLICANT (Direct access after pre-processing) =====
        "Primary_FirstName": "primary.demographic.firstName"
        "Primary_LastName": "primary.demographic.lastName"
        "Primary_MiddleName": "primary.demographic.middleName"
        "Primary_DOB": "primary.demographic.dateOfBirth"
        "Primary_SSN": "primary.demographic.ssn"
        "Primary_Gender": "primary.demographic.gender"
        "Primary_Email": "primary.demographic.email"
        "Primary_Phone": "primary.demographic.phone"
        
        # ===== SPOUSE APPLICANT =====
        "Spouse_FirstName": "spouse.demographic.firstName"
        "Spouse_LastName": "spouse.demographic.lastName"
        "Spouse_MiddleName": "spouse.demographic.middleName"
        "Spouse_DOB": "spouse.demographic.dateOfBirth"
        "Spouse_SSN": "spouse.demographic.ssn"
        "Spouse_Gender": "spouse.demographic.gender"
        "Spouse_Email": "spouse.demographic.email"
        "Spouse_Phone": "spouse.demographic.phone"
        
        # ===== DEPENDENT 1 =====
        "Dependent1_FirstName": "dependent1.demographic.firstName"
        "Dependent1_LastName": "dependent1.demographic.lastName"
        "Dependent1_MiddleName": "dependent1.demographic.middleName"
        "Dependent1_DOB": "dependent1.demographic.dateOfBirth"
        "Dependent1_SSN": "dependent1.demographic.ssn"
        "Dependent1_Gender": "dependent1.demographic.gender"
        
        # ===== DEPENDENT 2 =====
        "Dependent2_FirstName": "dependent2.demographic.firstName"
        "Dependent2_LastName": "dependent2.demographic.lastName"
        "Dependent2_MiddleName": "dependent2.demographic.middleName"
        "Dependent2_DOB": "dependent2.demographic.dateOfBirth"
        "Dependent2_SSN": "dependent2.demographic.ssn"
        "Dependent2_Gender": "dependent2.demographic.gender"
        
        # ===== DEPENDENT 3 =====
        "Dependent3_FirstName": "dependent3.demographic.firstName"
        "Dependent3_LastName": "dependent3.demographic.lastName"
        "Dependent3_MiddleName": "dependent3.demographic.middleName"
        "Dependent3_DOB": "dependent3.demographic.dateOfBirth"
        "Dependent3_SSN": "dependent3.demographic.ssn"
        "Dependent3_Gender": "dependent3.demographic.gender"
        
        # ===== BILLING ADDRESS =====
        "Billing_Street": "billing.street"
        "Billing_Street2": "billing.street2"
        "Billing_City": "billing.city"
        "Billing_State": "billing.state"
        "Billing_ZipCode": "billing.zipCode"
        "Billing_County": "billing.county"
        
        # ===== MAILING ADDRESS =====
        "Mailing_Street": "mailing.street"
        "Mailing_Street2": "mailing.street2"
        "Mailing_City": "mailing.city"
        "Mailing_State": "mailing.state"
        "Mailing_ZipCode": "mailing.zipCode"
        "Mailing_County": "mailing.county"
        
        # ===== MEDICAL PLAN =====
        "Medical_PlanName": "medical.planName"
        "Medical_PlanId": "medical.planId"
        "Medical_Premium": "medical.monthlyPremium"
        "Medical_Deductible": "medical.deductible"
        
        # ===== DENTAL PLAN =====
        "Dental_PlanName": "dental.planName"
        "Dental_PlanId": "dental.planId"
        "Dental_Premium": "dental.monthlyPremium"
        "Dental_Deductible": "dental.deductible"
        
        # ===== VISION PLAN =====
        "Vision_PlanName": "vision.planName"
        "Vision_PlanId": "vision.planId"
        "Vision_Premium": "vision.monthlyPremium"
        "Vision_Deductible": "vision.deductible"
        
        # ===== PRIOR COVERAGE (PRIMARY) =====
        "PriorMedical_Carrier": "primaryPriorMedical.carrierName"
        "PriorMedical_PolicyNumber": "primaryPriorMedical.policyNumber"
        "PriorMedical_TerminationDate": "primaryPriorMedical.terminationDate"
        
        "PriorDental_Carrier": "primaryPriorDental.carrierName"
        "PriorDental_PolicyNumber": "primaryPriorDental.policyNumber"
        "PriorDental_TerminationDate": "primaryPriorDental.terminationDate"
        
        # ===== CALCULATED/FLAGS =====
        "HasSpouse": "hasSpouse"
        "HasMedical": "hasMedical"
        "HasDental": "hasDental"
        "HasVision": "hasVision"
        "TotalMonthlyPremium": "totalMonthlyPremium"
        "TotalAnnualPremium": "totalAnnualPremium"
        "DependentCount": "dependentCount"
        "AdditionalDependentCount": "additionalDependentCount"
    
    # Addendum for 4+ dependents
    - name: additional-dependents-addendum
      type: freemarker
      template: additional-dependents-addendum.ftl
      enabled: true
      # FreeMarker accesses original nested structure from "application" key
